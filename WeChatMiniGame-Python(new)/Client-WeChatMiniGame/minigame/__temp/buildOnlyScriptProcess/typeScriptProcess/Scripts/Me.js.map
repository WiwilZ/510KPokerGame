{"version":3,"sources":["__temp/buildOnlyScriptProcess/inlineFunctionProcess/Scripts/Me.ts"],"names":[],"mappings":"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","file":"Me.js","sourcesContent":["import engine from \"engine\";\nimport { databus } from \"./Databus\";\nimport MyHandCard from \"./MyHandCard\";\nimport { urlToSpriteFrame } from \"./utils\";\n\n\ninterface ActionModel {\n    pattern: string,\n    weight: number\n}\n\n\n/* bomb weight\n负510K 0\n正510K 1\n0  3333 52\n......\n12 2222 64\n0  33333 65\n......\n12 22222 25\ncard + 13 * count\n*/\n\n\nclass CardHeap {\n    public cardScriptList: MyHandCard[] = [];\n    private cardCountList = Array(13).fill(0);\n    private actionModel: ActionModel = null;\n\n    public constructor() {\n\n    }\n\n    public get action() {\n        return {\n            model: this.actionModel,\n            cards: this.sortedCardScriptList.map(scrit => scrit.cardIndex)\n        };\n    }\n\n\n    public get sortedCardScriptList() {\n        return this.cardScriptList.sort((a, b) => a.cardIndex - b.cardIndex);\n    }\n\n    public add(cardScript: MyHandCard) {\n        this.cardScriptList.push(cardScript);\n        this.cardCountList[cardScript.cardWeigt] += 1;\n        this.actionModel = null;\n        this.checkSingleRepeat() || this.checkSequence() || this.check510K();\n    }\n\n    public remove(cardScript: MyHandCard) {\n        this.cardScriptList.splice(this.cardScriptList.indexOf(cardScript), 1);\n        this.cardCountList[cardScript.cardWeigt] -= 1;\n        this.actionModel = null;\n        if (this.cardScriptList.length === 0) return;\n        this.checkSingleRepeat() || this.checkSequence() || this.check510K();\n    }\n\n    public clear() {\n        this.cardScriptList = [];\n        this.cardCountList = Array(13).fill(0);\n        this.actionModel = null;\n    }\n\n    public isGreaterThan(actionModel: ActionModel) {\n        if (this.actionModel === null) return false;\n        if (actionModel === null) return true;\n        if (this.actionModel.pattern === actionModel.pattern) {\n            return this.actionModel.weight > actionModel.weight;\n        }\n        return this.actionModel.pattern === 'bomb';\n    }\n\n    // single double triple non-510K bomb\n    private checkSingleRepeat() {\n        const weight = this.cardScriptList[0].cardWeigt;\n        if (this.cardScriptList.every(v => v.cardWeigt === weight)) {\n            const count = this.cardScriptList.length;\n            if (count === 1) {\n                this.actionModel = {\n                    pattern: 'single',\n                    weight\n                };\n            } else if (count === 2) {\n                this.actionModel = {\n                    pattern: 'double',\n                    weight\n                };\n            } else if (count === 3) {\n                this.actionModel = {\n                    pattern: 'triple',\n                    weight\n                };\n            } else {\n                this.actionModel = {\n                    pattern: 'bomb',\n                    weight: weight + 13 * count\n                };\n            }\n            return true;\n        }\n        return false;\n    }\n\n    // i_double i_triple\n    private checkSequence() {\n        // 不能含`2`\n        if (this.cardCountList[12] > 0) return false;\n\n        const firstCard = this.cardCountList.findIndex(v => v > 0);\n        const count = this.cardCountList[firstCard];\n        if (!(count === 2 || count === 3)) return false;\n\n        const lastCard = (() => {\n            for (let i = 11; i >= 0; i--) {\n                if (this.cardCountList[i] > 0) {\n                    return i;\n                }\n            }\n        })();\n        const seqLen = lastCard - firstCard + 1;\n        if (seqLen < 2) return false;\n\n        if (this.cardCountList.slice(firstCard + 1, lastCard + 1).every(v => v === count)) {\n            this.actionModel = {\n                pattern: `${seqLen}_${count === 2 ? 'double' : 'triple'}`,\n                weight: firstCard\n            };\n            return true;\n        }\n        return false;\n    }\n\n    private check510K() {\n        if (this.cardScriptList.length === 3 && this.cardCountList[2] === 1 && this.cardCountList[7] === 1 && this.cardCountList[10] === 1) {\n            const suits = this.cardScriptList.map(v => v.cardSuit);\n            this.actionModel = {\n                pattern: '510K',\n                weight: suits[0] === suits[1] && suits[1] === suits[2] ? 1 : 0\n            };\n            return true;\n        }\n        return false;\n    }\n}\n\n\n@engine.decorators.serialize(\"Me\")\nexport default class Me extends engine.Script {\n    @engine.decorators.property({\n        type: engine.TypeNames.UISprite\n    })\n    public avatarSprite: engine.UISprite;\n\n    @engine.decorators.property({\n        type: engine.TypeNames.UILabel\n    })\n    public nicknameLabel: engine.UILabel;\n\n    @engine.decorators.property({\n        type: engine.TypeNames.UISprite\n    })\n    public bankerCardSprite: engine.UISprite;\n\n\n    @engine.decorators.property({\n        type: engine.TypeNames.UIButton\n    })\n    public playButton: engine.UIButton;\n    @engine.decorators.property({\n        type: engine.TypeNames.TouchInput\n    })\n    public playTouchInput: engine.TouchInputComponent;\n\n\n    @engine.decorators.property({\n        type: engine.TypeNames.UIButton\n    })\n    public passButton: engine.UIButton;\n    @engine.decorators.property({\n        type: engine.TypeNames.TouchInput\n    })\n    public passTouchInput: engine.TouchInputComponent;\n\n\n    @engine.decorators.property({\n        type: engine.TypeNames.UIButton\n    })\n    public changeButton: engine.UIButton;\n    @engine.decorators.property({\n        type: engine.TypeNames.TouchInput\n    })\n    public changeTouchInput: engine.TouchInputComponent;\n\n\n    @engine.decorators.property({\n        type: engine.TypeNames.UIButton\n    })\n    public skipButton: engine.UIButton;\n    @engine.decorators.property({\n        type: engine.TypeNames.TouchInput\n    })\n    public skipTouchInput: engine.TouchInputComponent;\n\n\n    @engine.decorators.property({\n        type: engine.TypeNames.Transform2D\n    })\n    public myHandTrans: engine.Transform2D;\n    @engine.decorators.property({\n        type: engine.TypeNames.Transform2D\n    })\n    public myActionTrans: engine.Transform2D;\n\n    @engine.decorators.property({\n        type: engine.TypeNames.UISprite\n    })\n    public passSprite: engine.UISprite;\n\n    @engine.decorators.property({\n        type: engine.TypeNames.UILabel\n    })\n    public scoreLabel: engine.UILabel;\n\n\n    private handCompList: {\n        sprite: engine.UISprite,\n        script: MyHandCard\n    }[];\n    private actionSpriteList: engine.UISprite[];\n\n    private selectedActionCards = new CardHeap();\n    private selectedBankerCard: MyHandCard = null;\n    private lastActionModel: ActionModel = null;\n    private myScore: number;\n    private onClickHandler: (selected: boolean, script: MyHandCard) => void;\n\n    private playerExitHandler;\n    private dealHandler;\n    private playerPlayHandler;\n\n    public onAwake() {\n        this.init();\n\n        urlToSpriteFrame(databus.avatarUrl).then((spriteFrame: engine.SpriteFrame) => this.avatarSprite.spriteFrame = spriteFrame);\n        this.nicknameLabel.text = databus.nickname;\n\n        this.playTouchInput.onClick.add(this.play.bind(this));\n        this.passTouchInput.onClick.add(this.pass.bind(this));\n        this.changeTouchInput.onClick.add(this.change.bind(this));\n        this.skipTouchInput.onClick.add(this.skip.bind(this));\n\n        engine.game.customEventEmitter.on('player_exit', this.playerExitHandler);\n        engine.game.customEventEmitter.on('deal', this.dealHandler);\n        engine.game.customEventEmitter.on('player_play', this.playerPlayHandler);\n\n        this.reset();\n    }\n\n    public onDestroy() {\n        engine.game.customEventEmitter.removeListener('player_exit', this.playerExitHandler);\n        engine.game.customEventEmitter.removeListener('deal', this.dealHandler);\n        engine.game.customEventEmitter.removeListener('player_play', this.playerPlayHandler);\n    }\n\n    private init() {\n        this.handCompList = this.myHandTrans.children.map(child => {\n            return {\n                sprite: child.entity.getComponent(engine.UISprite),\n                script: child.entity.getComponent(engine.Script)\n            }\n        });\n        this.actionSpriteList = this.myActionTrans.children.map(child => child.entity.getComponent(engine.UISprite));\n\n        this.playerExitHandler = this.onPlayerExit.bind(this);\n        this.dealHandler = this.onDeal.bind(this);\n        this.playerPlayHandler = this.onPlayerPlay.bind(this);\n    }\n\n    private onPlayerExit() {\n        this.reset();\n    }\n\n    private onDeal({ banker_seat, banker_card, can_change_banker_card, my_hand }) {\n        this.handCompList.forEach(({ sprite, script }, i) => {\n            script.cardIndex = my_hand[i];\n            script.putBack();\n            script.onClickCallback = selected => this.onClickHandler(selected, script);\n            sprite.spriteFrame = databus.cardSpriteframes[script.cardIndex];\n            sprite.entity.active = true;\n        });\n        if (banker_seat === databus.mySeat) {\n            this.bankerCardSprite.spriteFrame = databus.cardSpriteframes[banker_card];\n            this.bankerCardSprite.entity.active = true;\n            if (can_change_banker_card) {\n                this.onClickHandler = this.onSelectBankerCard;\n                this.disableChange();\n                this.showChangeButtonGroup();\n            } else {\n                this.onClickHandler = this.onSelectActionCards;\n                this.disablePlay();\n                this.playButton.entity.active = true;\n            }\n        } else {\n            this.onClickHandler = this.onSelectActionCards;\n            this.disablePlay();\n        }\n        this.scoreLabel.text = `score: ${this.myScore}`;\n    }\n\n    private onPlayerPlay(data) {\n        if (data.scorer !== undefined) {\n            this.lastActionModel = null;\n            this.hideAction();\n        } else if (data.action.model !== null) {\n            this.lastActionModel = data.action.model;\n        }\n        if (data.scorer === databus.mySeat) {\n            this.myScore += data.score;\n            this.scoreLabel.text = `score: ${this.myScore}`;\n        }\n        if (data.next_seat === databus.mySeat) {\n            this.playButton.entity.active = true;\n            this.passButton.entity.active = data.scorer === undefined;\n            this.hideAction();\n        }\n    }\n\n    private onSelectActionCards(selected: boolean, script: MyHandCard) {\n        if (selected) {\n            this.selectedActionCards.add(script);\n            console.log('add card', script.cardIndex);\n        } else {\n            this.selectedActionCards.remove(script);\n            console.log('remove card', script.cardIndex);\n        }\n        if (this.selectedActionCards.isGreaterThan(this.lastActionModel)) {\n            this.enablePlay();\n        } else {\n            this.disablePlay();\n        }\n    }\n\n    private onSelectBankerCard(selected: boolean, script: MyHandCard) {\n        if (selected) {\n            this.selectedBankerCard?.putBack();\n            this.selectedBankerCard = script;\n            console.log('select banker card', script.cardIndex);\n            this.enableChange();\n        } else {\n            this.selectedBankerCard = null;\n            console.log('remove banker card');\n            this.disableChange();\n        }\n    }\n\n    private play() {\n        console.log('play cards', this.selectedActionCards.action);\n        engine.game.customEventEmitter.emit('play', {\n            action: this.selectedActionCards.action\n        }, () => {\n            this.hideAction();\n            this.selectedActionCards.sortedCardScriptList.forEach((script, i) => {\n                script.entity.active = false;\n                this.actionSpriteList[i].spriteFrame = databus.cardSpriteframes[script.cardIndex];\n                this.actionSpriteList[i].entity.active = true;\n            });\n            this.selectedActionCards.clear();\n            this.hidePlayButtonGroup();\n        });\n    }\n\n    private pass() {\n        console.log('play pass action');\n        engine.game.customEventEmitter.emit('play', {\n            action: {\n                model: null,\n                cards: []\n            }\n        }, () => {\n            this.hideAction();\n            this.passSprite.entity.active = true;\n            this.selectedActionCards.cardScriptList.forEach(script => script.putBack());\n            this.selectedActionCards.clear();\n            this.hidePlayButtonGroup();\n        });\n    }\n\n    private change() {\n        console.log('change banker card', this.selectedBankerCard.cardIndex);\n        engine.game.customEventEmitter.emit('change_banker_card', {\n            banker_card: this.selectedBankerCard.cardIndex\n        }, () => {\n            this.bankerCardSprite.spriteFrame = databus.cardSpriteframes[this.selectedBankerCard.cardIndex];\n            this.skip();\n        });\n    }\n\n    private skip() {\n        this.selectedBankerCard?.putBack();\n        this.selectedBankerCard = null;\n        this.hideChangeButtonGroup();\n        this.playButton.entity.active = true;\n        this.onClickHandler = this.onSelectActionCards;\n    }\n\n\n    private disablePlay() {\n        this.playButton.disable = true;\n        this.playTouchInput.active = false;\n    }\n\n    private enablePlay() {\n        this.playButton.disable = false;\n        this.playTouchInput.active = true;\n    }\n\n    private disableChange() {\n        this.changeButton.disable = true;\n        this.changeTouchInput.active = false;\n    }\n\n    private enableChange() {\n        this.changeButton.disable = false;\n        this.changeTouchInput.active = true;\n    }\n\n    private reset() {\n        this.selectedActionCards.clear();\n        this.selectedBankerCard = null;\n        this.myScore = 0;\n        this.scoreLabel.text = '';\n        this.bankerCardSprite.entity.active = false;\n        this.lastActionModel = null;\n        this.hideAction();\n        this.hideHand();\n        this.hidePlayButtonGroup();\n        this.hideChangeButtonGroup();\n    }\n\n    private hidePlayButtonGroup() {\n        this.playButton.entity.active = false;\n        this.passButton.entity.active = false;\n    }\n\n    private hideChangeButtonGroup() {\n        this.changeButton.entity.active = false;\n        this.skipButton.entity.active = false;\n    }\n    private showChangeButtonGroup() {\n        this.changeButton.entity.active = true;\n        this.skipButton.entity.active = true;\n    }\n\n    private hideHand() {\n        this.handCompList.forEach(({ sprite }) => sprite.entity.active = false);\n    }\n\n    private hideAction() {\n        this.actionSpriteList.forEach(sprite => sprite.entity.active = false);\n        this.passSprite.entity.active = false;\n    }\n}\n"]}