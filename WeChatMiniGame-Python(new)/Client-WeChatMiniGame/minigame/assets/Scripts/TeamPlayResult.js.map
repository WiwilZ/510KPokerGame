{"version":3,"sources":["__temp/buildProcess/inlineFunctionProcess/Scripts/TeamPlayResult.ts"],"names":[],"mappings":"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","file":"TeamPlayResult.js","sourcesContent":["import engine from \"engine\";\nimport { databus } from \"./Databus\";\n\n\n@engine.decorators.serialize(\"Player\")\nexport class Player {\n    @engine.decorators.property({\n        type: engine.TypeNames.UISprite\n    })\n    public avatarSprite: engine.UISprite;\n\n    @engine.decorators.property({\n        type: engine.TypeNames.UILabel\n    })\n    public nicknameLabel: engine.UILabel;\n\n    @engine.decorators.property({\n        type: engine.TypeNames.UILabel\n    })\n    public orderLabel: engine.UILabel;\n\n    @engine.decorators.property({\n        type: engine.TypeNames.UILabel\n    })\n    public scoreLabel: engine.UILabel;\n}\n\n@engine.decorators.serialize(\"Team\")\nexport class Team {\n    @engine.decorators.property({\n        type: [Player]\n    })\n    public playerList: Player[] = [];\n\n    @engine.decorators.property({\n        type: engine.TypeNames.UILabel\n    })\n    public finalScoreLabel: engine.UILabel;\n}\n\n\n@engine.decorators.serialize(\"TeamPlayResult\")\nexport default class TeamPlayResult extends engine.Script {\n    @engine.decorators.property({\n        type: [Team]\n    })\n    public teamList: Team[] = [];\n\n    private playerExitHandler;\n    private playerPlayHandler;\n\n\n    public onAwake() {\n        this.init();\n\n        engine.game.customEventEmitter.on('player_exit', this.playerExitHandler);\n        engine.game.customEventEmitter.on('player_play', this.playerPlayHandler);\n\n        this.reset();\n    }\n\n    public onDestroy() {\n        engine.game.customEventEmitter.removeListener('player_exit', this.playerExitHandler);\n        engine.game.customEventEmitter.removeListener('player_play', this.playerPlayHandler);\n    }\n\n    private init() {\n        this.playerExitHandler = this.onPlayerExit.bind(this);\n        this.playerPlayHandler = this.onPlayerPlay.bind(this);\n    }\n\n    private reset() {\n        this.entity.transform2D.children[0].entity.active = false;\n    }\n\n    private onPlayerExit() {\n        this.reset();\n    }\n\n    private onPlayerPlay({ team_play_result }) {\n        if (team_play_result !== undefined) {\n            this.teamList.forEach((team, i) => {\n                const { players, team_score, addition } = team_play_result[i];\n                team.playerList.forEach((player, j) => {\n                    const { seat, score, order } = players[j];\n                    const { avatar, nickname } = databus.playerInfoList[seat];\n                    player.avatarSprite.spriteFrame = avatar;\n                    player.nicknameLabel.text = nickname;\n                    switch (order) {\n                        case 0:\n                            player.orderLabel.text = '头游';\n                            break;\n                        case 1:\n                            player.orderLabel.text = '二游';\n                            break;\n                        case 2:\n                            player.orderLabel.text = '三游';\n                            break;\n                        case 3:\n                            player.orderLabel.text = '尾游';\n                            break;\n                        default:\n                            player.orderLabel.text = '';\n                            break;\n                    }\n                    player.scoreLabel.text = `${score}分`;\n                });\n                team.finalScoreLabel.text = `${addition === 0 ? '' : addition > 0 ? `+<style|color=#FFFF00>${addition}</style> = ` : `-<style|color=#FFFF00>${-addition}</style> = `}<style|color=#FF0000>${team_score}</style>分`;\n            });\n\n            this.entity.transform2D.children[0].entity.active = true;\n        }\n    }\n}\n"]}